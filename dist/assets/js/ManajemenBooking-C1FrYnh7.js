import{r as a,W as G,j as o,a as g,y as S}from"./app-CKhyJ4gm.js";import{A as J}from"./AdminLayout-D8-3Js1L.js";import{X as K}from"./index.es-C-Wrnv7o.js";import{B as f}from"./ButtonAdmin-ir0pVVQ-.js";import"./moment-C5S46NFB.js";import{M as i}from"./Modal-C2p2uCjZ.js";import{B as W}from"./Button-D3-pOwhD.js";/* empty css            */import"./index-Dx4H4bw4.js";import"./emotion-unitless.esm-sScrWPmR.js";import"./ThemeProvider-DnvZDrLW.js";import"./setPrototypeOf-CL05xPcL.js";import"./divWithClassName-Bd0xnve-.js";const Y="_search_d01m6_41",l={"table-wrapper":"_table-wrapper_d01m6_1","title-table":"_title-table_d01m6_8","sub-wrapper":"_sub-wrapper_d01m6_18","form-search":"_form-search_d01m6_25","icon-search":"_icon-search_d01m6_33",search:Y};function me({bookings:s}){console.log("Bookings data:",s),s.forEach((e,t)=>{console.log(`Booking ${t}:`,e)}),console.log(s),a.useState(!1);const[w,u]=a.useState(!1),[m,y]=a.useState(null),[C,v]=a.useState(1),B=10;console.log(s);const[r,D]=a.useState(""),[E,L]=a.useState(s);a.useEffect(()=>{const e=s.filter(t=>{var n,d,j,b,_,k;return((n=t.user_nama)==null?void 0:n.toLowerCase().includes(r.toLowerCase()))||((d=t.nomor_polisi)==null?void 0:d.toLowerCase().includes(r.toLowerCase()))||((j=t.jenis_layanan)==null?void 0:j.toLowerCase().includes(r.toLowerCase()))||((b=t.jadwal_booking)==null?void 0:b.toLowerCase().includes(r.toLowerCase()))||((_=t.booking_status)==null?void 0:_.toLowerCase().includes(r.toLowerCase()))||((k=t.invoice_status)==null?void 0:k.toLowerCase().includes(r.toLowerCase()))});L(e)},[r,s]);const{data:$,setData:P,put:q,post:z,delete:N,processing:Q,errors:x}=G({id:"",user_id:"",jenis_layanan:"",jadwal_booking:"",catatan:""}),[A,M]=a.useState(s),h=()=>u(!1),T=e=>{u(!0),y(e)},R=e=>{switch(e){case"Diproses":return{backgroundColor:"#1fe71b",color:"white",borderRadius:"5px"};case"Selesai":return{backgroundColor:"#1887d7",color:"white",borderRadius:"5px"};case"Dibatalkan":return{backgroundColor:"#ff0000",color:"white",borderRadius:"5px"};default:return{}}},H=e=>{switch(e){case"Paid":return{backgroundColor:"#1fe71b",color:"white"};case"Unpaid":return{backgroundColor:"#ff0000",color:"white"};default:return{}}},I=(e,t)=>{S.visit(route("admin.booking.updateStatusBooking",{booking:e}),{method:"PUT",data:{status:t},preserveScroll:!0,onSuccess:()=>{p(!c)},onError:n=>{console.error("Error updating Booking status",n)}})},U=(e,t)=>{const n=t==="Paid"?"Unpaid":"Paid";S.visit(route("admin.booking.updateStatusPembayaran",{invoice:e}),{method:"PUT",data:{status:n},preserveScroll:!0,onSuccess:()=>{p(!c)},onError:d=>{console.error("Error updating payment status",d)}})},F=[{name:"No",selector:(e,t)=>t+1+(C-1)*B,width:"7%"},{name:"Nama",selector:e=>e.user_nama},{name:"Service",selector:e=>e.jenis_layanan},{name:"Status Booking",selector:e=>o.jsxs("select",{value:e.booking_status,onChange:t=>I(e.booking_id,t.target.value),style:R(e.booking_status),children:[o.jsx("option",{value:"Diproses",children:"Diproses"}),o.jsx("option",{value:"Selesai",children:"Selesai"}),o.jsx("option",{value:"Dibatalkan",children:"Dibatalkan"})]})},{name:"Tanggal",selector:e=>new Date(e.jadwal_booking).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"}),width:"14%"},{name:"Status Pembayaran",selector:e=>o.jsx(f,{style:H(e.invoice_status),onClick:()=>U(e.invoice_id,e.invoice_status),children:e.invoice_status}),width:"17%"},{name:"Action",selector:e=>o.jsxs(o.Fragment,{children:[o.jsx(g,{title:"Invoice",href:route("admin.booking.createInvoice",{booking:e.booking_id}),children:o.jsx("box-icon",{name:"file",type:"solid",color:"#f16211"})}),o.jsx(g,{title:"Edit",href:route("admin.booking.edit",[e.booking_id]),className:"mx-2",children:o.jsx("box-icon",{name:"edit",type:"solid",color:"#f16211"})}),o.jsx("button",{onClick:()=>T(e),style:{color:"#f16211"},children:o.jsx("box-icon",{name:"trash",type:"solid",color:"#f16211"})})]})}],[V,O]=a.useState({}),[c,p]=a.useState(!1),X=e=>{e.preventDefault(),N(route("admin.booking.delete",{booking:m.booking_id}),{preserveScroll:!0,onSuccess:()=>{u(!1),p(!c)},onError:()=>{console.error("Error deleting Booking")}})};return a.useEffect(()=>{O(x)},[x]),a.useEffect(()=>{M(s),P({id:"",user_id:"",jenis_layanan:"",nomor_polisi:"",jadwal_booking:"",catatan:""})},[c,A]),o.jsxs(J,{title:"MANAJEMEN BOOKING",children:[o.jsxs("div",{className:l["table-wrapper"],children:[o.jsxs("div",{className:l["sub-wrapper"],children:[o.jsx(g,{href:route("admin.booking.create"),style:{textDecoration:"none"},children:o.jsxs(f,{variant:"danger",children:[o.jsx("box-icon",{color:"white",name:"plus"})," ",o.jsx("span",{children:"Tambah Booking"})]})}),o.jsxs("form",{action:"#",className:l["form-search"],children:[o.jsx("span",{className:l["icon-search"],children:o.jsx("box-icon",{name:"search",color:"#f16211"})}),o.jsx("input",{type:"text",name:"search",id:"search",placeholder:"Cari Booking",autoComplete:"off",className:l.search,value:r,onChange:e=>D(e.target.value)})]})]}),o.jsx(K,{columns:F,data:E,pagination:!0,onChangePage:e=>v(e)})]}),o.jsxs(i,{show:w,onHide:h,children:[o.jsx(i.Header,{closeButton:!0,children:o.jsx(i.Title,{children:"Hapus Booking"})}),o.jsx(i.Body,{children:o.jsxs("p",{children:["Apakah anda yakin ingin menghapus booking:"," ",o.jsx("b",{children:m&&m.name}),"?"]})}),o.jsxs(i.Footer,{children:[o.jsx(W,{variant:"secondary",onClick:h,children:"Close"}),o.jsx("form",{onSubmit:X,action:"#",method:"post",children:o.jsx(f,{type:"submit",variant:"primary",onClick:h,style:{backgroundColor:"#f16211",borderColor:"#f16211"},children:"Ya, Hapus"})})]})]})]})}export{me as default};
